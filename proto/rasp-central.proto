syntax = "proto3";

option go_package = "github.com/n1k1x86/rasp-grpc-contract/gen";

message RegSSRFAgentRequest {
    string ServiceName = 1;
    string ServiceDescription = 2;
    repeated string HostRules = 3;
    repeated string IPRules = 4;
    repeated string RegexpRules = 5;
    string AgentName = 6; 
}

message RegSSRFAgentResponse {
    int64 Status = 1;
    string Detail = 2;
    string AgentID = 3;
}

message DeactivateSSRFAgentRequest {
    string ServiceName = 1;
    string AgentName = 2;
    string AgentID = 3;
}

message DeactivateSSRFAgentResponse {
    int64 Status = 1;
    string Detail = 2;
}

service RASPCentral {
    rpc RegSSRFAgent(RegSSRFAgentRequest) returns (RegSSRFAgentResponse);
    rpc DeactivateSSRFAgent(DeactivateSSRFAgentRequest) returns (DeactivateSSRFAgentResponse);
}